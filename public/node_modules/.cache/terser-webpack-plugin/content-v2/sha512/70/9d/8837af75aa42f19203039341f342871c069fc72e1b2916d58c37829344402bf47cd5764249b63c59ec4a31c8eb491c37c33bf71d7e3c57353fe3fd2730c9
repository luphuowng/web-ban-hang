{"code":"!function(e){function t(r){if(i[r])return i[r].exports;var n=i[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var i={};t.m=e,t.c=i,t.d=function(e,i,r){t.o(e,i)||Object.defineProperty(e,i,{enumerable:!0,get:r})},t.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},t.t=function(e,i){if(1&i&&(e=t(e)),8&i)return e;if(4&i&&\"object\"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:e}),2&i&&\"string\"!=typeof e)for(var n in e)t.d(r,n,function(t){return e[t]}.bind(null,n));return r},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,\"a\",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p=\"\",t(t.s=0)}([function(e,t,i){i(1)},function(e,t,i){e.exports=i(2)},function(e){e.exports=function(e){const t=e.Store,i=()=>{};return class extends t{constructor(e={}){if(super(e),!e.client)throw new Error(\"A client must be directly provided to the RedisStore\");this.prefix=null==e.prefix?\"sess:\":e.prefix,this.scanCount=+e.scanCount||100,this.serializer=e.serializer||JSON,this.client=e.client,this.ttl=e.ttl||86400,this.disableTouch=e.disableTouch||!1}get(e,t=i){let r=this.prefix+e;this.client.get(r,(e,i)=>{if(e)return t(e);if(!i)return t();let r;try{r=this.serializer.parse(i)}catch(e){return t(e)}return t(null,r)})}set(e,t,r=i){let n,l=[this.prefix+e];try{n=this.serializer.stringify(t)}catch(e){return r(e)}l.push(n),l.push(\"EX\",this._getTTL(t)),this.client.set(l,r)}touch(e,t,r=i){if(this.disableTouch)return r();let n=this.prefix+e;this.client.expire(n,this._getTTL(t),(e,t)=>e?r(e):1===t?void r(null,\"OK\"):r(null,\"EXPIRED\"))}destroy(e,t=i){let r=this.prefix+e;this.client.del(r,t)}clear(e=i){this._getAllKeys((t,i)=>t?e(t):void this.client.del(i,e))}length(e=i){this._getAllKeys((t,i)=>t?e(t):e(null,i.length))}ids(e=i){let t=this.prefix.length;this._getAllKeys((i,r)=>i?e(i):(r=r.map(e=>e.substr(t)),e(null,r)))}all(e=i){let t=this.prefix.length;this._getAllKeys((i,r)=>i?e(i):0===r.length?e(null,[]):void this.client.mget(r,(i,n)=>{if(i)return e(i);let l;try{l=n.reduce((e,i,n)=>i?((i=this.serializer.parse(i)).id=r[n].substr(t),e.push(i),e):e,[])}catch(e){i=e}return e(i,l)}))}_getTTL(e){let t;if(e&&e.cookie&&e.cookie.expires){let i=+new Date(e.cookie.expires)-Date.now();t=Math.ceil(i/1e3)}else t=this.ttl;return t}_getAllKeys(e=i){let t=this.prefix+\"*\";this._scanKeys({},0,t,this.scanCount,e)}_scanKeys(e={},t,r,n,l=i){this.client.scan([t,\"match\",r,\"count\",n],(t,i)=>{if(t)return l(t);let[s,o]=i;for(let t of o)e[t]=!0;return 0==+s?void l(null,Object.keys(e)):this._scanKeys(e,s,r,n,l)})}}}}]);","extractedComments":[]}